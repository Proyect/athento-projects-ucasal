{% extends "ui/base.html" %}
{% block content %}
<div class="card shadow-sm mb-3">
  <div class="card-header"><i class="bi bi-search me-2"></i><strong>Búsqueda</strong></div>
  <div class="card-body">
    <form method="post">
      {% csrf_token %}
      <div class="row g-2 align-items-center">
        <div class="col-md-10">
          <input class="form-control" name="query" placeholder="Consulta SELECT..." value="{{ query }}" />
          <div class="form-text">Ej.: SELECT uuid, filename FROM Document WHERE filename LIKE '%document%'</div>
        </div>
        <div class="col-md-2 d-grid">
          <button class="btn btn-primary" type="submit"><i class="bi bi-search"></i> Buscar</button>
        </div>
      </div>
    </form>
    {% if error %}<div class="alert alert-danger mt-3"><i class="bi bi-exclamation-triangle me-1"></i>{{ error }}</div>{% endif %}
  </div>
</div>

<div class="card shadow-sm">
  <div class="card-header d-flex align-items-center"><i class="bi bi-list-ul me-2"></i><strong>Resultados</strong></div>
  <div class="card-body p-0">
    <div class="table-responsive">
      <table class="table table-hover align-middle mb-0">
        <thead class="table-light">
          <tr><th style="width:40%">UUID</th><th>Filename</th><th style="width:220px">Acciones</th></tr>
        </thead>
        <tbody>
        {% for item in items %}
          <tr>
            <td><code class="small">{{ item.uuid }}</code></td>
            <td>{{ item.filename }}</td>
            <td>
              <a class="btn btn-sm btn-outline-primary" href="/ui/titulos/{{ item.uuid }}/"><i class="bi bi-eye"></i> Ver</a>
              <a class="btn btn-sm btn-outline-secondary" href="/athento/files/{{ item.uuid }}/download"><i class="bi bi-download"></i> Descargar</a>
              <form method="post" action="/ui/titulos/{{ item.uuid }}/delete/" class="d-inline">
                {% csrf_token %}
                <button class="btn btn-sm btn-outline-danger" onclick="return confirm('¿Eliminar el documento?');"><i class="bi bi-trash"></i> Borrar</button>
              </form>
            </td>
          </tr>
        {% empty %}
          <tr><td colspan="3" class="text-muted p-3">Sin resultados</td></tr>
        {% endfor %}
        </tbody>
      </table>
    </div>
  </div>
</div>
{% endblock %}
